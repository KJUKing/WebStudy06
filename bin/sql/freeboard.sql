--기본형 게시판
CREATE SEQUENCE FREEBOARD_SEQ;
CREATE TABLE FREEBOARD(
    BO_NO NUMBER(6), --글번호 
    BO_TITLE VARCHAR2(50 CHAR) NOT NULL, --제목 
    BO_WRITER VARCHAR2(20 CHAR) NOT NULL, --작성자명 
    BO_IP VARCHAR2(50) NOT NULL , --IP 
    BO_MAIL VARCHAR2(50 CHAR), --email 
    BO_PASS VARCHAR2(200) NOT NULL, --비번 
    BO_CONTENT CLOB, --내용 
    BO_DATE DATE DEFAULT SYSDATE, --작성일 
    BO_HIT NUMBER(4) DEFAULT 0, --조회수
    CONSTRAINT PK_FREEBOARD PRIMARY KEY(BO_NO)
);
--dummy data
INSERT INTO freeboard (
    bo_no,    bo_title,    bo_writer,    bo_ip,    bo_mail,    bo_pass,
    bo_content,    bo_hit
) 
SELECT FREEBOARD_SEQ.NEXTVAL, 
    MEM_NAME||'이 남기는 글', MEM_NAME,
    '192.168.43.'||MOD(NVL(MEM_MILEAGE, 1), 256),
    MEM_MAIL, MEM_PASS,
    MEM_NAME||'이 글을 남겼는데, 자기 직업은 '||MEM_JOB||
    '이고, <br /> 취미는 '||MEM_LIKE||'라네.',
    MOD(NVL(MEM_MILEAGE, 23), 1000)
FROM MEMBER;
COMMIT;
COMMENT ON COLUMN FREEBOARD.BO_NO IS '글번호';
COMMENT ON COLUMN FREEBOARD.BO_TITLE IS '제목';
COMMENT ON COLUMN FREEBOARD.BO_WRITER IS '작성자';
COMMENT ON COLUMN FREEBOARD.BO_IP IS '아이피';
COMMENT ON COLUMN FREEBOARD.BO_MAIL IS '이메일';
COMMENT ON COLUMN FREEBOARD.BO_PASS IS '비밀번호';
COMMENT ON COLUMN FREEBOARD.BO_CONTENT IS '내용';
COMMENT ON COLUMN FREEBOARD.BO_DATE IS '작성일';
COMMENT ON COLUMN FREEBOARD.BO_HIT IS '조회수';
-- 공통 파일 테이블
CREATE SEQUENCE ATCH_FILE_SEQ;
CREATE TABLE ATCH_FILE (
   ATCH_FILE_ID NUMBER PRIMARY KEY, -- 파일 그룹 아이디
   CREAT_DT DATE DEFAULT sysdate NOT NULL , -- 파일 그룹 생성일
   USE_AT CHAR(1) DEFAULT 'Y'-- 해당 파일 그룹 사용 여부
);
COMMENT ON COLUMN ATCH_FILE.ATCH_FILE_ID IS '파일그룹아이디';
COMMENT ON COLUMN ATCH_FILE.CREAT_DT IS '파일그룹생성일';
COMMENT ON COLUMN ATCH_FILE.USE_AT IS '사용여부';
CREATE TABLE ATCH_FILE_DETAIL(
  ATCH_FILE_ID NUMBER, -- 파일 그룹 아이디
  FILE_SN NUMBER(3), -- 그룹내 순번
  FILE_STRE_COURS VARCHAR2(2000), -- 파일 저장 경로
  STRE_FILE_NM VARCHAR2(255) NOT NULL, -- 저장 파일명
  ORIGNL_FILE_NM VARCHAR2(255) NOT NULL, -- 원본 파일명
  FILE_EXTSN VARCHAR2(20), -- 파일 확장자
  FILE_CN CLOB, -- 파일 내용
  FILE_SIZE NUMBER, -- 파일 크기
  FILE_FANCYSIZE VARCHAR2(20), -- 파일 팬시사이즈
  FILE_MIME VARCHAR2(200) DEFAULT 'application/octet-stream', -- 파일 Mime
  FILE_DWNCNT NUMBER DEFAULT 0, -- 다운로드수
  CONSTRAINT PK_ATCH_FILE_DETAIL PRIMARY KEY(ATCH_FILE_ID, FILE_SN)  -- 복합키(파일그룹아이디,파일순번)
);
COMMENT ON COLUMN ATCH_FILE_DETAIL.ATCH_FILE_ID IS '파일그룹아이디';
COMMENT ON COLUMN ATCH_FILE_DETAIL.FILE_SN IS '그룹내파일번호';
COMMENT ON COLUMN ATCH_FILE_DETAIL.FILE_STRE_COURS IS '저장경로';
COMMENT ON COLUMN ATCH_FILE_DETAIL.STRE_FILE_NM IS '저장명';
COMMENT ON COLUMN ATCH_FILE_DETAIL.ORIGNL_FILE_NM IS '원본파일명';
COMMENT ON COLUMN ATCH_FILE_DETAIL.FILE_EXTSN IS '확장자';
COMMENT ON COLUMN ATCH_FILE_DETAIL.FILE_CN IS '파일내용';
COMMENT ON COLUMN ATCH_FILE_DETAIL.FILE_SIZE IS '파일크기';
COMMENT ON COLUMN ATCH_FILE_DETAIL.FILE_FANCYSIZE IS '팬시사이즈';
COMMENT ON COLUMN ATCH_FILE_DETAIL.FILE_MIME IS 'MIME';
COMMENT ON COLUMN ATCH_FILE_DETAIL.FILE_DWNCNT IS '다운수';
-- 게시판 테이블 변경
ALTER TABLE FREEBOARD ADD (ATCH_FILE_ID NUMBER);
COMMENT ON COLUMN FREEBOARD.ATCH_FILE_ID IS '첨부파일그룹ID';

